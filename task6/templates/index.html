<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fake User Generator</title>
    <style>
        body { font-family: Arial; max-width: 1400px; margin: 0 auto; padding: 20px; }
        .container { background: white; border-radius: 10px; padding: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { color: #333; border-bottom: 3px solid #4CAF50; padding-bottom: 10px; }
        .controls { background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 30px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        select, input { width: 200px; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        button { background: #4CAF50; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px; }
        button:hover { background: #45a049; }
        .btn-secondary { background: #008CBA; }
        .btn-secondary:hover { background: #007399; }
        .loading { display: none; text-align: center; padding: 20px; }
        .error { color: #d32f2f; background: #ffebee; padding: 10px; border-radius: 4px; margin: 10px 0; display: none; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { background: #4CAF50; color: white; padding: 12px; text-align: left; }
        td { padding: 10px; border-bottom: 1px solid #ddd; }
        tr:hover { background: #f5f5f5; }
        .stats { margin-top: 20px; padding: 15px; background: #e8f5e9; border-radius: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Fake User Generator</h1>
        
        <div class="controls">
            <div class="form-group">
                <label for="locale">Locale:</label>
                <select id="locale">
                    {% for locale in locales %}
                    <option value="{{ locale[0] }}">{{ locale[1] }}</option>
                    {% endfor %}
                </select>
            </div>
            
            <div class="form-group">
                <label for="seed">Seed Value:</label>
                <input type="number" id="seed" value="12345" min="0">
            </div>
            
            <div class="form-group">
                <label for="batchSize">Batch Size:</label>
                <select id="batchSize">
                    <option value="5">5 users</option>
                    <option value="10" selected>10 users</option>
                    <option value="20">20 users</option>
                </select>
            </div>
            
            <button onclick="generateUsers()">Generate Users</button>
            <button class="btn-secondary" onclick="nextBatch()">Next Batch</button>
            <button onclick="resetGenerator()">Reset</button>
            
            <div class="loading" id="loading">‚è≥ Generating users...</div>
            <div class="error" id="errorContainer"></div>
            
            <div class="stats">
                Batch: <span id="currentBatch">0</span> | 
                Total Generated: <span id="totalGenerated">0</span> |
                Seed: <span id="currentSeed">12345</span>
            </div>
        </div>
        
        <table id="usersTable">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Email</th>
                    <th>Phone</th>
                </tr>
            </thead>
            <tbody id="usersBody">
                <tr><td colspan="5" style="text-align: center; padding: 40px; color: #999;">No users generated yet</td></tr>
            </tbody>
        </table>
    </div>

    <script>
        let currentBatchIndex = 0;
        let currentSeed = 12345;
        let currentLocale = 'en_US';
        let currentBatchSize = 10;
        
        function generateUsers() {
            currentBatchIndex = 0;
            currentSeed = parseInt(document.getElementById('seed').value);
            currentLocale = document.getElementById('locale').value;
            currentBatchSize = parseInt(document.getElementById('batchSize').value);
            
            fetchUsers();
        }
        
        function nextBatch() {
            currentBatchIndex++;
            fetchUsers();
        }
        
        function resetGenerator() {
            currentBatchIndex = 0;
            currentSeed = 12345;
            currentLocale = 'en_US';
            currentBatchSize = 10;
            
            document.getElementById('seed').value = currentSeed;
            document.getElementById('locale').value = currentLocale;
            document.getElementById('batchSize').value = currentBatchSize;
            
            document.getElementById('usersBody').innerHTML = `
                <tr><td colspan="5" style="text-align: center; padding: 40px; color: #999;">No users generated yet</td></tr>
            `;
            
            document.getElementById('currentBatch').textContent = '0';
            document.getElementById('totalGenerated').textContent = '0';
            document.getElementById('currentSeed').textContent = '12345';
            document.getElementById('errorContainer').style.display = 'none';
        }
        
        function fetchUsers() {
            const loading = document.getElementById('loading');
            const errorContainer = document.getElementById('errorContainer');
            
            loading.style.display = 'block';
            errorContainer.style.display = 'none';
            
            fetch('/generate', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    locale: currentLocale,
                    seed: currentSeed,
                    batch_index: currentBatchIndex,
                    batch_size: currentBatchSize
                })
            })
            .then(response => response.json())
            .then(data => {
                loading.style.display = 'none';
                
                if (data.success) {
                    displayUsers(data.users);
                    updateStats(data);
                } else {
                    showError(data.error);
                }
            })
            .catch(error => {
                loading.style.display = 'none';
                showError('Error: ' + error.message);
            });
        }
        
        function displayUsers(users) {
            const tbody = document.getElementById('usersBody');
            
            if (users.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center;">No users generated</td></tr>';
                return;
            }
            
            tbody.innerHTML = users.map(user => `
                <tr>
                    <td>${user.user_id}</td>
                    <td><strong>${user.first_name}</strong></td>
                    <td><strong>${user.last_name}</strong></td>
                    <td>${user.email}</td>
                    <td>${user.phone || ''}</td>
                </tr>
            `).join('');
        }
        
        function updateStats(data) {
            document.getElementById('currentBatch').textContent = currentBatchIndex;
            document.getElementById('totalGenerated').textContent = data.total_generated;
            document.getElementById('currentSeed').textContent = currentSeed;
        }
        
        function showError(message) {
            const errorContainer = document.getElementById('errorContainer');
            errorContainer.textContent = 'Error: ' + message;
            errorContainer.style.display = 'block';
        }
        
        // Initialize
        window.onload = function() {
            document.getElementById('currentSeed').textContent = currentSeed;
        };
    </script>
</body>
</html>
